<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ITIVA - IT Infrastructure Vulnerability Assessment</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Vue.js 3 -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- Chart.js for Radar Chart -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: 'Inter', sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      .fade-enter-active,
      .fade-leave-active {
        transition: opacity 0.3s ease;
      }
      .fade-enter-from,
      .fade-leave-to {
        opacity: 0;
      }
      .custom-scrollbar::-webkit-scrollbar {
        width: 6px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: #f1f1f1;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 3px;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: #555;
      }
    </style>
  </head>
  <body class="bg-gray-50 text-gray-800">
    <div id="app">
      <!-- Main Vue App will be mounted here -->
    </div>

    <script type="module">
      const { createApp, ref, computed, onMounted, defineComponent, watch } = Vue

      // --- MOCK DATA ---
      const mockQuestions = [
        {
          id: 1,
          category: 'Website Strength',
          text: 'Is your website traffic encrypted using a valid and current SSL/TLS certificate (HTTPS)?',
          options: [
            'Yes, on all pages, with HSTS enabled',
            'Yes, standard certificate on all pages',
            'Only on sensitive pages',
            'Certificate is expired/misconfigured',
            'No, we use HTTP only',
          ],
        },
        {
          id: 2,
          category: 'Website Strength',
          text: "How often are your website's software components (CMS, plugins) updated?",
          options: [
            'Automatically within 48 hours',
            'Weekly',
            'Sporadically',
            'Rarely or never',
            "I don't know",
          ],
        },
        {
          id: 3,
          category: 'Website Strength',
          text: 'Placeholder Q3',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 4,
          category: 'Website Strength',
          text: 'Placeholder Q4',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 5,
          category: 'Website Strength',
          text: 'Placeholder Q5',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 6,
          category: 'Website Strength',
          text: 'Placeholder Q6',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 7,
          category: 'Website Strength',
          text: 'Placeholder Q7',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 8,
          category: 'Website Strength',
          text: 'Have you implemented security headers like CSP?',
          options: [
            'Yes, a strong CSP',
            'Yes, basic headers',
            'Aware but not implemented',
            'What are security headers?',
            'No',
          ],
        },
        {
          id: 9,
          category: 'Devices & Network',
          text: 'Do you maintain an up-to-date inventory of all devices on your network?',
          options: [
            'Yes, automated real-time inventory',
            'Yes, a manual spreadsheet',
            'Partial or outdated inventory',
            "I don't know",
            'No inventory',
          ],
        },
        {
          id: 10,
          category: 'Devices & Network',
          text: 'Placeholder Q10',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 11,
          category: 'Devices & Network',
          text: 'Placeholder Q11',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 12,
          category: 'Devices & Network',
          text: 'Placeholder Q12',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 13,
          category: 'Devices & Network',
          text: 'Placeholder Q13',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 14,
          category: 'Devices & Network',
          text: 'Placeholder Q14',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 15,
          category: 'Devices & Network',
          text: 'Is a firewall configured to block unsolicited incoming traffic?',
          options: [
            'Yes, dedicated hardware firewall',
            'Yes, software firewalls on endpoints',
            'Only the default router firewall',
            'Firewall is disabled',
            "I don't know",
          ],
        },
        {
          id: 16,
          category: 'Compliance Documentation',
          text: 'Do you have a formally documented Information Security Policy?',
          options: [
            'Yes, reviewed annually and trained on',
            'Yes, a documented policy exists',
            'Informal or outdated version',
            "I don't know",
            'No',
          ],
        },
        {
          id: 17,
          category: 'Compliance Documentation',
          text: 'Placeholder Q17',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 18,
          category: 'Compliance Documentation',
          text: 'Placeholder Q18',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 19,
          category: 'Compliance Documentation',
          text: 'Placeholder Q19',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 20,
          category: 'Compliance Documentation',
          text: 'Placeholder Q20',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 21,
          category: 'Compliance Documentation',
          text: 'Are your data handling practices compliant with relevant regulations?',
          options: [
            'Yes, formally audited',
            'We believe we are compliant',
            'Aware but no formal steps taken',
            'Not aware of regulations',
            "I don't know",
          ],
        },
        {
          id: 22,
          category: 'Cyber Security Implementations',
          text: 'Do you use an Intrusion Detection/Prevention System (IDS/IPS)?',
          options: [
            'Yes, managed and monitored',
            'Yes, a device is running',
            'Planning to implement',
            'What is an IDS/IPS?',
            'No',
          ],
        },
        {
          id: 23,
          category: 'Cyber Security Implementations',
          text: 'Placeholder Q23',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 24,
          category: 'Cyber Security Implementations',
          text: 'Placeholder Q24',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 25,
          category: 'Cyber Security Implementations',
          text: 'Placeholder Q25',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 26,
          category: 'Cyber Security Implementations',
          text: 'Placeholder Q26',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 27,
          category: 'Cyber Security Implementations',
          text: 'Placeholder Q27',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 28,
          category: 'Cyber Security Implementations',
          text: 'Placeholder Q28',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 29,
          category: 'Cyber Security Implementations',
          text: 'Placeholder Q29',
          options: ['A', 'B', 'C', 'D', 'E'],
        },
        {
          id: 30,
          category: 'Cyber Security Implementations',
          text: 'Is access to sensitive data restricted based on the principle of least privilege?',
          options: [
            'Yes, strictly controlled and reviewed',
            'Yes, basic roles exist',
            'Access granted but rarely revoked',
            'Most employees have access to most data',
            "I don't know",
          ],
        },
      ]

      const mockRankings = [
        {
          rank: 1,
          name: 'Innovate UK Ltd.',
          score: 89,
          location: 'London',
          type: 'FinTech',
          lat: 51.5074,
          lng: -0.1278,
          report: { overall: 89, ws: 95, dn: 85, cd: 80, cs: 92 },
        },
        {
          rank: 2,
          name: 'Manchester Tech Co.',
          score: 85,
          location: 'Manchester',
          type: 'SaaS',
          lat: 53.4808,
          lng: -2.2426,
          report: { overall: 85, ws: 90, dn: 88, cd: 75, cs: 82 },
        },
        {
          rank: 3,
          name: 'Bristol Digital Agency',
          score: 82,
          location: 'Bristol',
          type: 'Marketing',
          lat: 51.4545,
          lng: -2.5879,
          report: { overall: 82, ws: 85, dn: 80, cd: 88, cs: 79 },
        },
        {
          rank: 4,
          name: 'Cambridge AI Solutions',
          score: 79,
          location: 'Cambridge',
          type: 'AI/ML',
          lat: 52.2053,
          lng: 0.1218,
          report: { overall: 79, ws: 75, dn: 85, cd: 82, cs: 78 },
        },
        {
          rank: 5,
          name: 'Secure Hosting UK',
          score: 78,
          location: 'London',
          type: 'IT Services',
          lat: 51.515,
          lng: -0.09,
          report: { overall: 78, ws: 88, dn: 70, cd: 75, cs: 80 },
        },
        {
          rank: 6,
          name: 'Birmingham Logistics',
          score: 75,
          location: 'Birmingham',
          type: 'Logistics',
          lat: 52.4862,
          lng: -1.8904,
          report: { overall: 75, ws: 70, dn: 78, cd: 80, cs: 72 },
        },
        {
          rank: 7,
          name: 'Leeds E-commerce',
          score: 71,
          location: 'Leeds',
          type: 'E-commerce',
          lat: 53.8008,
          lng: -1.5491,
          report: { overall: 71, ws: 78, dn: 65, cd: 70, cs: 70 },
        },
        {
          rank: 8,
          name: 'Oxford EduTech',
          score: 68,
          location: 'Oxford',
          type: 'Education',
          lat: 51.752,
          lng: -1.2577,
          report: { overall: 68, ws: 65, dn: 72, cd: 60, cs: 75 },
        },
        {
          rank: 9,
          name: 'Glasgow Creative',
          score: 65,
          location: 'Glasgow',
          type: 'Creative',
          lat: 55.8642,
          lng: -4.2518,
          report: { overall: 65, ws: 72, dn: 60, cd: 68, cs: 61 },
        },
        {
          rank: 10,
          name: 'Data Insights London',
          score: 64,
          location: 'London',
          type: 'Data Analytics',
          lat: 51.512,
          lng: -0.13,
          report: { overall: 64, ws: 60, dn: 68, cd: 65, cs: 63 },
        },
        {
          rank: 11,
          name: 'Cardiff Solutions',
          score: 62,
          location: 'Cardiff',
          type: 'IT Services',
          lat: 51.4816,
          lng: -3.1791,
          report: { overall: 62, ws: 68, dn: 65, cd: 55, cs: 60 },
        },
        {
          rank: 12,
          name: 'Edinburgh Consulting',
          score: 60,
          location: 'Edinburgh',
          type: 'Consulting',
          lat: 55.9533,
          lng: -3.1883,
          report: { overall: 60, ws: 55, dn: 62, cd: 65, cs: 58 },
        },
        {
          rank: 13,
          name: 'Liverpool Retail',
          score: 58,
          location: 'Liverpool',
          type: 'Retail',
          lat: 53.4084,
          lng: -2.9916,
          report: { overall: 58, ws: 62, dn: 55, cd: 50, cs: 65 },
        },
        {
          rank: 14,
          name: 'Nottingham Gaming',
          score: 55,
          location: 'Nottingham',
          type: 'Gaming',
          lat: 52.9548,
          lng: -1.1581,
          report: { overall: 55, ws: 50, dn: 60, cd: 58, cs: 52 },
        },
        {
          rank: 15,
          name: 'Sheffield Manufacturing',
          score: 52,
          location: 'Sheffield',
          type: 'Manufacturing',
          lat: 53.3811,
          lng: -1.4701,
          report: { overall: 52, ws: 45, dn: 58, cd: 55, cs: 50 },
        },
        {
          rank: 16,
          name: 'Newcastle Health',
          score: 49,
          location: 'Newcastle',
          type: 'Healthcare',
          lat: 54.9783,
          lng: -1.6178,
          report: { overall: 49, ws: 52, dn: 50, cd: 45, cs: 49 },
        },
        {
          rank: 17,
          name: 'Aberdeen Energy',
          score: 45,
          location: 'Aberdeen',
          type: 'Energy',
          lat: 57.1497,
          lng: -2.0943,
          report: { overall: 45, ws: 40, dn: 55, cd: 40, cs: 45 },
        },
        {
          rank: 18,
          name: 'Belfast Logistics',
          score: 42,
          location: 'Belfast',
          type: 'Logistics',
          lat: 54.5973,
          lng: -5.9301,
          report: { overall: 42, ws: 48, dn: 40, cd: 35, cs: 45 },
        },
        {
          rank: 19,
          name: 'Southampton Marine',
          score: 38,
          location: 'Southampton',
          type: 'Marine',
          lat: 50.9097,
          lng: -1.4044,
          report: { overall: 38, ws: 35, dn: 45, cd: 40, cs: 32 },
        },
        {
          rank: 20,
          name: 'Plymouth Construction',
          score: 35,
          location: 'Plymouth',
          type: 'Construction',
          lat: 50.3755,
          lng: -4.1427,
          report: { overall: 35, ws: 30, dn: 40, cd: 38, cs: 32 },
        },
      ]

      // --- SVG Icons ---
      const ShieldCheckIcon = {
        template: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>`,
      }
      const ChartBarIcon = {
        template: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>`,
      }
      const DocumentTextIcon = {
        template: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>`,
      }
      const DownloadIcon = {
        template: `<svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>`,
      }
      const BackIcon = {
        template: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" /></svg>`,
      }
      const GoogleIcon = {
        template: `<svg class="w-5 h-5" aria-hidden="true" fill="currentColor" viewBox="0 0 24 24"><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z" fill="#FBBC05"/><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/><path d="M1 1h22v22H1z" fill="none"/></svg>`,
      }
      const FacebookIcon = {
        template: `<svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878V14.89h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33V21.88C18.343 21.128 22 16.991 22 12z"></svg>`,
      }

      // --- Layout Components ---
      const AppHeader = defineComponent({
        props: ['isLoggedIn', 'isAdmin'],
        emits: ['navigate', 'logout'],
        template: `
                <header class="bg-white shadow-sm sticky top-0 z-50">
                    <div class="container mx-auto px-6 py-4 flex justify-between items-center">
                        <div @click="$emit('navigate', 'HomePage')" class="cursor-pointer text-2xl font-bold text-gray-800">
                            IT<span class="text-blue-600">I</span>VA
                        </div>
                        <nav class="hidden md:flex items-center space-x-8">
                            <a @click.prevent="$emit('navigate', 'HomePage')" href="#" class="text-gray-600 hover:text-blue-600 transition-colors">Home</a>
                            <a @click.prevent="$emit('navigate', 'AboutUsPage')" href="#" class="text-gray-600 hover:text-blue-600 transition-colors">About Us</a>
                            <a v-if="isLoggedIn && !isAdmin" @click.prevent="$emit('navigate', 'DashboardPage')" href="#" class="text-gray-600 hover:text-blue-600 transition-colors">Dashboard</a>
                            <a v-if="isAdmin" @click.prevent="$emit('navigate', 'AdminDashboardPage')" href="#" class="text-gray-600 hover:text-blue-600 transition-colors">Admin Dashboard</a>
                        </nav>
                        <div v-if="!isLoggedIn" class="flex items-center space-x-4">
                           <button @click="$emit('navigate', 'LoginPage')" class="hidden md:block text-gray-600 hover:text-blue-600 font-medium transition-colors">Login</button>
                           <button @click="$emit('navigate', 'LoginPage')" class="bg-blue-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-blue-700 transition-transform transform hover:scale-105 shadow-lg">
                               Get Started
                           </button>
                        </div>
                        <div v-if="isLoggedIn" class="flex items-center space-x-4">
                           <button @click="$emit('logout')" class="bg-red-500 text-white font-bold py-2 px-5 rounded-lg hover:bg-red-600 transition-transform transform hover:scale-105 shadow-lg">
                               Logout
                           </button>
                        </div>
                    </div>
                </header>`,
      })

      const AppFooter = defineComponent({
        template: `<footer class="bg-gray-800 text-white mt-auto">
                        <div class="container mx-auto px-6 py-8 text-center">
                            <p>&copy; ${new Date().getFullYear()} ITIVA. All rights reserved.</p>
                            <p class="text-sm text-gray-400 mt-2">Your Partner in Digital Security in UK.</p>
                        </div>
                    </footer>`,
      })

      const Notification = defineComponent({
        props: ['message', 'type'], // 'success' or 'error'
        template: `
                <div v-if="message" class="fixed top-5 right-5 z-50 p-4 rounded-lg shadow-lg text-white" 
                    :class="type === 'success' ? 'bg-green-500' : 'bg-red-500'">
                    {{ message }}
                </div>
            `,
      })

      // --- Page Components ---
      const HomePage = defineComponent({
        name: 'HomePage',
        components: { AppHeader, AppFooter, ShieldCheckIcon, ChartBarIcon, DocumentTextIcon },
        props: ['isLoggedIn', 'isAdmin'],
        emits: ['navigate', 'logout'],
        setup() {
          const rankings = ref(mockRankings)
          const rankingFilter = ref('ranking') // 'ranking', 'location', or 'type'
          const selectedRanking = ref(rankings.value[0])

          const groupedRankings = computed(() => {
            if (rankingFilter.value === 'ranking') {
              return { 'Top 20 Rankings': rankings.value.slice().sort((a, b) => a.rank - b.rank) }
            }
            const grouped = rankings.value.reduce((acc, rank) => {
              const key = rank[rankingFilter.value]
              if (!acc[key]) acc[key] = []
              acc[key].push(rank)
              return acc
            }, {})
            return Object.fromEntries(Object.entries(grouped).sort())
          })

          function selectRanking(item) {
            selectedRanking.value = item
          }

          return { rankingFilter, groupedRankings, selectedRanking, selectRanking }
        },
        template: `
                <div class="flex flex-col min-h-screen">
                    <AppHeader :is-logged-in="isLoggedIn" :is-admin="isAdmin" @navigate="$emit('navigate', $event)" @logout="$emit('logout')" />
                    <main class="flex-grow">
                         <!-- Hero Section -->
                         <div class="bg-white"><div class="container mx-auto px-6 py-20 md:py-32 text-center"><h1 class="text-4xl md:text-6xl font-extrabold text-gray-900 leading-tight mb-4">Assess Your IT Vulnerabilities with <span class="text-blue-600">AI-Powered</span> Precision</h1><p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto mb-8">ITIVA (IT Infrastructure Vulnerability Assessment) is an intelligent platform that helps businesses in the UK identify, analyze, and mitigate security risks across their digital infrastructure.</p><button @click="$emit('navigate', 'LoginPage')" class="bg-blue-600 text-white font-bold py-4 px-8 rounded-lg text-lg hover:bg-blue-700 transition-transform transform hover:scale-105 shadow-xl">Start Your Free Assessment</button></div></div>
                         <!-- Rankings Section -->
                        <section id="rankings" class="py-20 bg-gray-50/70">
                            <div class="container mx-auto px-6">
                                <div class="text-center mb-12">
                                    <h2 class="text-3xl md:text-4xl font-bold text-gray-800">UK's Most Secure Businesses</h2>
                                    <p class="text-gray-600 mt-4 max-w-2xl mx-auto">Discover the top-ranked businesses based on their comprehensive ITIVA vulnerability score.</p>
                                    <div class="mt-6">
                                        <span class="mr-4 text-gray-700 font-medium">Group by:</span>
                                        <button @click="rankingFilter = 'ranking'" :class="['px-4 py-2 rounded-lg mr-2 transition', rankingFilter === 'ranking' ? 'bg-blue-600 text-white shadow' : 'bg-white text-gray-600 hover:bg-gray-100']">Ranking</button>
                                        <button @click="rankingFilter = 'location'" :class="['px-4 py-2 rounded-lg mr-2 transition', rankingFilter === 'location' ? 'bg-blue-600 text-white shadow' : 'bg-white text-gray-600 hover:bg-gray-100']">Location</button>
                                        <button @click="rankingFilter = 'type'" :class="['px-4 py-2 rounded-lg transition', rankingFilter === 'type' ? 'bg-blue-600 text-white shadow' : 'bg-white text-gray-600 hover:bg-gray-100']">Business Type</button>
                                    </div>
                                </div>
                                <div class="bg-white rounded-xl shadow-lg flex" style="height: 600px;">
                                    <!-- Left Pane: List -->
                                    <div class="w-2/5 border-r border-gray-200 flex flex-col">
                                         <div class="p-4 border-b font-bold text-gray-700">Business Rankings</div>
                                         <div class="overflow-y-auto custom-scrollbar flex-grow">
                                             <div v-for="(group, groupName) in groupedRankings" :key="groupName" class="p-2">
                                                <h3 class="font-semibold text-sm text-blue-800 bg-blue-100 px-3 py-1 rounded-md mb-1 sticky top-0 z-10">{{ groupName }}</h3>
                                                <ul class="space-y-1">
                                                   <li v-for="item in group" :key="item.rank"
                                                       @click="selectRanking(item)"
                                                       class="p-2 rounded-md cursor-pointer flex items-center justify-between"
                                                       :class="selectedRanking && selectedRanking.rank === item.rank ? 'bg-blue-100' : 'hover:bg-gray-50'">
                                                       <div class="flex items-center truncate">
                                                           <span class="font-bold text-gray-400 mr-3 w-6 text-center flex-shrink-0">{{ item.rank }}</span>
                                                           <div class="truncate">
                                                               <p class="font-bold text-gray-800 text-sm truncate">{{ item.name }}</p>
                                                               <p class="text-xs text-gray-500 truncate">{{item.location}} - {{item.type}}</p>
                                                           </div>
                                                       </div>
                                                       <span class="font-extrabold text-base flex-shrink-0 ml-2" :class="item.score > 75 ? 'text-green-600' : item.score > 50 ? 'text-yellow-600' : 'text-red-600'">{{ item.score }}</span>
                                                   </li>
                                                </ul>
                                             </div>
                                         </div>
                                    </div>
                                    <!-- Right Pane: Details -->
                                    <div class="w-3/5 p-8 flex flex-col justify-center">
                                        <div v-if="selectedRanking">
                                            <h2 class="text-3xl font-bold text-gray-800">{{ selectedRanking.name }}</h2>
                                            <p class="text-md text-gray-500 mb-6">{{ selectedRanking.location }} - {{ selectedRanking.type }}</p>
                        
                                            <div class="flex items-center mb-8">
                                                <div class="w-1/2">
                                                    <p class="text-sm text-gray-600">Overall Security Score</p>
                                                    <p class="text-6xl font-extrabold" :class="selectedRanking.score > 75 ? 'text-green-600' : selectedRanking.score > 50 ? 'text-yellow-600' : 'text-red-600'">
                                                        {{ selectedRanking.score }}
                                                    </p>
                                                </div>
                                            </div>
                                            
                                            <div class="space-y-4">
                                                <div>
                                                    <div class="flex justify-between items-center mb-1"><span class="text-sm font-medium text-gray-700">Website Strength</span><span class="text-sm font-bold text-gray-700">{{ selectedRanking.report.ws }}</span></div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2.5"><div class="bg-blue-600 h-2.5 rounded-full" :style="{ width: selectedRanking.report.ws + '%' }"></div></div>
                                                </div>
                                                 <div>
                                                    <div class="flex justify-between items-center mb-1"><span class="text-sm font-medium text-gray-700">Devices & Network</span><span class="text-sm font-bold text-gray-700">{{ selectedRanking.report.dn }}</span></div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2.5"><div class="bg-blue-600 h-2.5 rounded-full" :style="{ width: selectedRanking.report.dn + '%' }"></div></div>
                                                </div>
                                                 <div>
                                                    <div class="flex justify-between items-center mb-1"><span class="text-sm font-medium text-gray-700">Compliance</span><span class="text-sm font-bold text-gray-700">{{ selectedRanking.report.cd }}</span></div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2.5"><div class="bg-blue-600 h-2.5 rounded-full" :style="{ width: selectedRanking.report.cd + '%' }"></div></div>
                                                </div>
                                                 <div>
                                                    <div class="flex justify-between items-center mb-1"><span class="text-sm font-medium text-gray-700">Cyber Security</span><span class="text-sm font-bold text-gray-700">{{ selectedRanking.report.cs }}</span></div>
                                                    <div class="w-full bg-gray-200 rounded-full h-2.5"><div class="bg-blue-600 h-2.5 rounded-full" :style="{ width: selectedRanking.report.cs + '%' }"></div></div>
                                                </div>
                                            </div>
                                        </div>
                                         <div v-else class="text-center text-gray-500">
                                            <p>Select a business to see details.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                         <!-- How it Works Section -->
                         <section id="how-it-works" class="py-20 bg-white"><div class="container mx-auto px-6"><div class="text-center mb-16"><h2 class="text-3xl md:text-4xl font-bold text-gray-800">How It Works</h2></div><div class="grid grid-cols-1 md:grid-cols-3 gap-10"><div class="bg-gray-50 p-8 rounded-xl text-center hover:shadow-lg transition-shadow"><div class="bg-blue-100 text-blue-600 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-6"><DocumentTextIcon /></div><h3 class="text-xl font-bold mb-2">1. Register & Answer</h3><p class="text-gray-600">Create your business profile and complete our straightforward, 30-question assessment.</p></div><div class="bg-gray-50 p-8 rounded-xl text-center hover:shadow-lg transition-shadow"><div class="bg-blue-100 text-blue-600 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-6"><ChartBarIcon /></div><h3 class="text-xl font-bold mb-2">2. AI-Powered Analysis</h3><p class="text-gray-600">Our system analyzes your answers to calculate your vulnerability score for each category.</p></div><div class="bg-gray-50 p-8 rounded-xl text-center hover:shadow-lg transition-shadow"><div class="bg-blue-100 text-blue-600 rounded-full h-16 w-16 flex items-center justify-center mx-auto mb-6"><ShieldCheckIcon /></div><h3 class="text-xl font-bold mb-2">3. Get Actionable Insights</h3><p class="text-gray-600">Receive an instant, detailed report with a visual Radar Chart and prioritized recommendations.</p></div></div></div></section>
                         <!-- Features Section -->
                         <section id="features" class="py-20 bg-gray-50/70"><div class="container mx-auto px-6"><div class="text-center mb-16"><h2 class="text-3xl md:text-4xl font-bold text-gray-800">Platform Features</h2></div><div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8"><div class="bg-white p-6 rounded-lg shadow"><h4 class="font-bold text-lg mb-2 text-blue-700">User Dashboard</h4><p class="text-gray-600 text-sm">Fill out business details, take the assessment, and view your results all in one place.</p></div><div class="bg-white p-6 rounded-lg shadow"><h4 class="font-bold text-lg mb-2 text-blue-700">Visual Reports</h4><p class="text-gray-600 text-sm">Instantly understand your security posture with an intuitive Radar Chart and detailed scores.</p></div><div class="bg-white p-6 rounded-lg shadow"><h4 class="font-bold text-lg mb-2 text-blue-700">Downloadable PDF</h4><p class="text-gray-600 text-sm">Export your full assessment report, including recommendations, for offline review and sharing.</p></div><div class="bg-white p-6 rounded-lg shadow"><h4 class="font-bold text-lg mb-2 text-blue-700">Admin Security Map</h4><p class="text-gray-600 text-sm">Admins can view a national security landscape, visualizing vulnerabilities by location.</p></div></div></div></section>
                    </main>
                    <AppFooter />
                </div>
            `,
      })

      const AboutUsPage = defineComponent({
        name: 'AboutUsPage',
        components: { AppHeader, AppFooter },
        props: ['isLoggedIn', 'isAdmin'],
        emits: ['navigate', 'logout'],
        setup() {
          const team = [
            {
              name: 'Dr. Evelyn Reed',
              role: 'Founder & Lead Security Architect',
              img: 'https://placehold.co/400x400/E2E8F0/4A5568?text=E.R',
            },
            {
              name: 'James Carter',
              role: 'Head of Penetration Testing',
              img: 'https://placehold.co/400x400/E2E8F0/4A5568?text=J.C',
            },
            {
              name: 'Aisha Adebayo',
              role: 'Compliance & GDPR Specialist',
              img: 'https://placehold.co/400x400/E2E8F0/4A5568?text=A.A',
            },
            {
              name: 'Ben Williams',
              role: 'Lead Frontend Developer',
              img: 'https://placehold.co/400x400/E2E8F0/4A5568?text=B.W',
            },
          ]
          return { team }
        },
        template: `
                <div class="flex flex-col min-h-screen">
                     <AppHeader :is-logged-in="isLoggedIn" :is-admin="isAdmin" @navigate="$emit('navigate', $event)" @logout="$emit('logout')" />
                     <main class="flex-grow bg-white py-16 px-6">
                        <div class="container mx-auto">
                            <div class="text-center mb-16">
                                <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900">About ITIVA</h1>
                                <p class="text-lg text-gray-600 mt-4 max-w-3xl mx-auto">We are a dedicated team of cybersecurity professionals committed to making the digital world safer for businesses in the UK.</p>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center mb-20">
                               <div>
                                   <h3 class="text-2xl font-bold text-gray-800 mb-4">Our Mission & Experience</h3>
                                   <p class="text-gray-600 mb-4">Our mission is to empower businesses with the knowledge and tools to proactively defend against cyber threats. With over 20 years of combined experience in cybersecurity, our team holds industry-leading certifications including CISSP, OSCP, and CISM. We blend automated intelligence with expert human insight to deliver unparalleled vulnerability assessments.</p>
                                   <p class="text-gray-600">We believe that robust security should be accessible to all businesses, not just large corporations. ITIVA was born from this belief, providing an affordable, intuitive, and powerful platform for self-assessment.</p>
                               </div>
                               <div class="w-full h-80 rounded-lg shadow-xl overflow-hidden">
                                    <iframe 
                                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2179.991209591494!2d-2.102372023377779!3d57.11796197371929!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x488410313f898139%3A0x24f31c7739556b10!2sRobert%20Gordon%20University!5e0!3m2!1sen!2suk!4v1718844838631!5m2!1sen!2suk" 
                                        width="100%" 
                                        height="100%" 
                                        style="border:0;" 
                                        allowfullscreen="" 
                                        loading="lazy" 
                                        referrerpolicy="no-referrer-when-downgrade">
                                    </iframe>
                               </div>
                            </div>
                            
                             <div class="text-center mb-12">
                                <h2 class="text-3xl font-bold text-gray-800">Meet the Team</h2>
                            </div>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                                <div v-for="member in team" :key="member.name" class="text-center">
                                    <img :src="member.img" class="w-40 h-40 rounded-full mx-auto mb-4 shadow-lg bg-gray-200">
                                    <h4 class="text-xl font-bold text-gray-800">{{ member.name }}</h4>
                                    <p class="text-gray-600">{{ member.role }}</p>
                                </div>
                            </div>
                        </div>
                     </main>
                    <AppFooter />
                </div>
            `,
      })

      const LoginPage = defineComponent({
        name: 'LoginPage',
        components: { GoogleIcon, FacebookIcon },
        emits: ['navigate', 'login', 'adminLogin'],
        setup(_, { emit }) {
          const activeTab = ref('login')
          const loginEmail = ref('')
          const loginPassword = ref('')
          const registrationData = ref({
            name: '',
            email: '',
            password: '',
            businessName: '',
            businessObjective: '',
            website: '',
            address: '',
          })

          function handleLogin() {
            if (loginEmail.value === 'admin@admin.com' && loginPassword.value === 'admin') {
              emit('adminLogin')
            } else {
              emit('login')
            }
          }
          function handleRegister() {
            emit('login')
          }
          onMounted(() => {
            console.log('LoginPage mounted. Google Maps API would initialize here.')
          })

          return {
            activeTab,
            loginEmail,
            loginPassword,
            registrationData,
            handleLogin,
            handleRegister,
          }
        },
        template: `<div class="min-h-screen bg-gray-50 flex flex-col items-center justify-center p-4"><div @click="$emit('navigate', 'HomePage')" class="cursor-pointer mb-8 text-3xl font-bold text-gray-800">IT<span class="text-blue-600">I</span>VA</div><div class="w-full max-w-md bg-white rounded-2xl shadow-xl p-8"><div class="flex border-b border-gray-200 mb-8"><button @click="activeTab = 'login'" :class="['w-1/2 py-4 text-center font-medium text-lg transition-colors', activeTab === 'login' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-500 hover:text-gray-700']">Login</button><button @click="activeTab = 'register'" :class="['w-1/2 py-4 text-center font-medium text-lg transition-colors', activeTab === 'register' ? 'text-blue-600 border-b-2 border-blue-600' : 'text-gray-500 hover:text-gray-700']">Register</button></div><div v-if="activeTab === 'login'"><form @submit.prevent="handleLogin"><div class="mb-4"><label for="login-email" class="block text-sm font-medium text-gray-700 mb-1">Email</label><input v-model="loginEmail" type="email" id="login-email" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="you@example.com"></div><div class="mb-6"><label for="login-password" class="block text-sm font-medium text-gray-700 mb-1">Password</label><input v-model="loginPassword" type="password" id="login-password" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="••••••••"><a href="#" class="text-sm text-blue-600 hover:underline mt-2 block text-right">Forgot Password?</a></div><button type="submit" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 shadow-lg">Login</button></form></div><div v-if="activeTab === 'register'"><form @submit.prevent="handleRegister"><div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"><div><label for="register-fullname" class="block text-sm font-medium text-gray-700 mb-1">Your Name</label><input v-model="registrationData.name" type="text" id="register-fullname" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="John Doe"></div><div><label for="register-bizname" class="block text-sm font-medium text-gray-700 mb-1">Business Name</label><input v-model="registrationData.businessName" type="text" id="register-bizname" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="Your Company Ltd."></div></div><div class="mb-4"><label for="register-email" class="block text-sm font-medium text-gray-700 mb-1">Email</label><input v-model="registrationData.email" type="email" id="register-email" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="you@example.com"></div><div class="mb-4"><label for="register-password" class="block text-sm font-medium text-gray-700 mb-1">Password</label><input v-model="registrationData.password" type="password" id="register-password" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="Create a strong password"></div><div class="mb-4"><label for="register-address" class="block text-sm font-medium text-gray-700 mb-1">Business Address</label><input type="text" id="register-address" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="Start typing your address..."></div><div class="mb-4"><label for="register-website" class="block text-sm font-medium text-gray-700 mb-1">Website</label><input v-model="registrationData.website" type="url" id="register-website" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="https://example.com"></div><div class="mb-6"><label for="register-objective" class="block text-sm font-medium text-gray-700 mb-1">Business Objective</label><textarea v-model="registrationData.businessObjective" id="register-objective" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg" placeholder="Describe your business..."></textarea></div><button type="submit" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 shadow-lg">Create Account</button></form></div><div class="mt-8"><div class="relative"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-300"></div></div><div class="relative flex justify-center text-sm"><span class="px-2 bg-white text-gray-500">Or continue with</span></div></div><div class="mt-6 grid grid-cols-2 gap-3"><div><a href="#" class="w-full inline-flex justify-center items-center py-3 px-4 border border-gray-300 rounded-lg shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"><GoogleIcon /><span class="ml-2">Google</span></a></div><div><a href="#" class="w-full inline-flex justify-center items-center py-3 px-4 border border-gray-300 rounded-lg shadow-sm bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"><FacebookIcon /><span class="ml-2">Facebook</span></a></div></div></div></div></div>`,
      })

      const DashboardPage = defineComponent({
        name: 'DashboardPage',
        components: { AppHeader, AppFooter },
        props: ['isLoggedIn', 'isAdmin', 'payload'],
        emits: ['navigate', 'logout'],
        setup(props, { emit }) {
          const assessmentCompleted = computed(() => props.payload?.assessmentCompleted || false)
          const overallScore = ref(0)
          function createRadarChart() {
            const ctx = document.getElementById('radarChart')
            if (ctx && assessmentCompleted.value) {
              const scores = { ws: 65, dn: 80, cd: 40, csi: 75 }
              overallScore.value = Math.round((scores.ws + scores.dn + scores.cd + scores.csi) / 4)
              new Chart(ctx, {
                type: 'radar',
                data: {
                  labels: [
                    'Website Strength',
                    'Devices & Network',
                    'Compliance',
                    'Cyber Security Impl.',
                  ],
                  datasets: [
                    {
                      label: 'Your Vulnerability Score',
                      data: [scores.ws, scores.dn, scores.cd, scores.csi],
                      backgroundColor: 'rgba(59, 130, 246, 0.2)',
                      borderColor: 'rgba(59, 130, 246, 1)',
                      borderWidth: 2,
                      pointBackgroundColor: 'rgba(59, 130, 246, 1)',
                    },
                  ],
                },
                options: {
                  scales: {
                    r: { angleLines: { display: false }, suggestedMin: 0, suggestedMax: 100 },
                  },
                  plugins: { legend: { display: false } },
                },
              })
            }
          }
          onMounted(createRadarChart)
          return { assessmentCompleted, overallScore }
        },
        template: `<div class="flex flex-col min-h-screen"><AppHeader :is-logged-in="isLoggedIn" :is-admin="isAdmin" @navigate="$emit('navigate', $event)" @logout="$emit('logout')" /><main class="flex-grow bg-gray-100 py-12 px-6"><div class="container mx-auto"><h1 class="text-3xl font-bold text-gray-800 mb-8">User Dashboard</h1><div v-if="!assessmentCompleted" class="text-center bg-white p-12 rounded-lg shadow-md"><h2 class="text-2xl font-bold mb-4">Welcome to ITIVA!</h2><p class="text-gray-600 mb-8 max-w-lg mx-auto">Your first step to a more secure business starts here. Complete the vulnerability assessment to get your personalized security report and recommendations.</p><button @click="$emit('navigate', 'QuestionnairePage')" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-blue-700 shadow-lg">Start Assessment Now</button></div><div v-if="assessmentCompleted" class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class="lg:col-span-2 bg-white p-8 rounded-lg shadow-md"><h2 class="text-2xl font-bold mb-6">Your Vulnerability Assessment Result</h2><div class="max-w-md mx-auto"><canvas id="radarChart"></canvas></div></div><div class="space-y-8"><div class="bg-white p-6 rounded-lg shadow-md text-center"><h3 class="text-lg font-medium text-gray-600">Overall Score</h3><p class="text-5xl font-extrabold text-green-600 my-2">{{ overallScore }}</p><p class="text-sm text-gray-500">A higher score indicates a stronger security posture.</p></div><div class="bg-white p-6 rounded-lg shadow-md"><h3 class="text-lg font-bold mb-4">Actions</h3><button @click="$emit('navigate', 'QuestionnairePage')" class="w-full text-center mb-4 bg-gray-100 text-gray-700 font-bold py-3 px-4 rounded-lg hover:bg-gray-200">Retake Assessment</button><button @click="$emit('navigate', 'ReportViewerPage')" class="w-full text-center bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700">View Report</button></div></div></div></div></main><AppFooter /></div>`,
      })

      const QuestionnairePage = defineComponent({
        name: 'QuestionnairePage',
        emits: ['navigate'],
        setup(_, { emit }) {
          const questions = ref(mockQuestions)
          const currentQuestionIndex = ref(0)
          const answers = ref({})
          const categoryBreaks = {
            'Website Strength': 8,
            'Devices & Network': 15,
            'Compliance Documentation': 21,
            'Cyber Security Implementations': 30,
          }
          const totalQuestions = 30
          const progress = computed(() => {
            const prog = { ws: 0, dn: 0, cd: 0, csi: 0 }
            const answeredCount = Object.keys(answers.value).length
            if (answeredCount <= categoryBreaks['Website Strength']) {
              prog.ws = (answeredCount / 8) * 100
            } else if (answeredCount <= categoryBreaks['Devices & Network']) {
              prog.ws = 100
              prog.dn = ((answeredCount - 8) / 7) * 100
            } else if (answeredCount <= categoryBreaks['Compliance Documentation']) {
              prog.ws = 100
              prog.dn = 100
              prog.cd = ((answeredCount - 15) / 6) * 100
            } else {
              prog.ws = 100
              prog.dn = 100
              prog.cd = 100
              prog.csi = ((answeredCount - 21) / 9) * 100
            }
            return prog
          })
          function nextQuestion() {
            if (currentQuestionIndex.value < questions.value.length - 1) {
              currentQuestionIndex.value++
            }
          }
          function prevQuestion() {
            if (currentQuestionIndex.value > 0) {
              currentQuestionIndex.value--
            }
          }
          function submitAssessment() {
            emit('navigate', 'DashboardPage', { assessmentCompleted: true })
          }
          return {
            questions,
            currentQuestionIndex,
            answers,
            progress,
            nextQuestion,
            prevQuestion,
            submitAssessment,
          }
        },
        template: `<div class="min-h-screen bg-gray-100 flex flex-col items-center justify-center p-4"><div class="w-full max-w-2xl"><div class="mb-4"><h3 class="text-sm font-medium text-gray-600 mb-2">Assessment Progress</h3><div class="flex rounded-full overflow-hidden h-3 bg-gray-200"><div class="bg-blue-500 transition-all duration-300" :style="{ width: progress.ws / 4 + '%' }"></div><div class="bg-green-500 transition-all duration-300" :style="{ width: progress.dn / 4 + '%' }"></div><div class="bg-yellow-500 transition-all duration-300" :style="{ width: progress.cd / 4 + '%' }"></div><div class="bg-red-500 transition-all duration-300" :style="{ width: progress.csi / 4 + '%' }"></div></div><div class="flex justify-between text-xs mt-1 text-gray-500"><span>Website</span><span>Network</span><span>Compliance</span><span>Security</span></div></div><div class="bg-white rounded-2xl shadow-xl p-8"><div v-if="questions[currentQuestionIndex]"><p class="text-sm font-bold text-blue-600 mb-2">{{ questions[currentQuestionIndex].category }}</p><h2 class="text-2xl font-bold text-gray-800 mb-8">{{ currentQuestionIndex + 1 }}. {{ questions[currentQuestionIndex].text }}</h2><div class="space-y-4"><label v-for="(option, index) in questions[currentQuestionIndex].options" :key="index" :class="['flex items-center p-4 border rounded-lg cursor-pointer transition-all', answers[currentQuestionIndex] === option ? 'border-blue-500 bg-blue-50 shadow-md' : 'border-gray-300 hover:border-gray-400']"><input type="radio" :name="'q' + currentQuestionIndex" :value="option" v-model="answers[currentQuestionIndex]" class="h-5 w-5 text-blue-600 focus:ring-blue-500"><span class="ml-4 text-gray-700">{{ option }}</span></label></div></div><div class="flex justify-between items-center mt-10"><button @click="prevQuestion" :disabled="currentQuestionIndex === 0" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed">Previous</button><p class="text-sm text-gray-500">{{ currentQuestionIndex + 1 }} / {{ questions.length }}</p><button v-if="currentQuestionIndex < questions.length - 1" @click="nextQuestion" class="px-6 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700">Next</button><button v-else @click="submitAssessment" class="px-6 py-2 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700">Submit</button></div></div></div></div>`,
      })

      const ReportViewerPage = defineComponent({
        name: 'ReportViewerPage',
        components: { DownloadIcon, BackIcon },
        props: ['payload', 'isAdmin'],
        emits: ['navigate'],
        setup(props, { emit }) {
          const summary = ref('')
          const isLoadingSummary = ref(true)
          const radarChartInstance = ref(null)

          const defaultReport = {
            name: 'Your Business Ltd.',
            scores: { ws: 65, dn: 80, cd: 40, csi: 75, overall: 65 },
            prioritizedRecs: [
              {
                rec: 'Implement a formal Incident Response Plan.',
                impact: '+15 pts',
                category: 'Compliance',
              },
              {
                rec: 'Enforce MFA on all critical systems.',
                impact: '+12 pts',
                category: 'Cyber Security',
              },
              {
                rec: 'Deploy a Web Application Firewall (WAF).',
                impact: '+10 pts',
                category: 'Website Strength',
              },
            ],
          }

          const reportData = computed(() => {
            if (props.payload && props.payload.name) {
              return {
                name: props.payload.name,
                scores: {
                  ws: props.payload.report.ws,
                  dn: props.payload.report.dn,
                  cd: props.payload.report.cd,
                  csi: props.payload.report.cs,
                  overall: props.payload.score,
                },
                // Recommendations could be made dynamic in a future version
                prioritizedRecs: defaultReport.prioritizedRecs,
              }
            }
            return defaultReport
          })

          const generateSummary = async () => {
            isLoadingSummary.value = true
            await new Promise((resolve) => setTimeout(resolve, 1000))
            const { name, scores } = reportData.value
            summary.value = `This executive summary provides a high-level overview of the IT infrastructure vulnerability assessment conducted for ${name}. The overall security score of <b>${scores.overall}</b> places the organization in a position with foundational security measures in place but highlights critical areas requiring immediate attention to mitigate significant risks. 
                    <br><br>The assessment reveals a notable strength in the <b>Devices & Network</b> category, scoring <b>${scores.dn}</b>. This indicates that core network security and device management protocols are relatively robust. However, this strength is contrasted by a considerable vulnerability in <b>Compliance Documentation</b>, which scored a low <b>${scores.cd}</b>. This represents a major compliance and operational risk, stemming from the likely absence of formally documented and regularly reviewed security policies, such as an Incident Response Plan or comprehensive data handling procedures. 
                    <br><br>The <b>Website Strength</b> score of <b>${scores.ws}</b> suggests that while some security practices are in effect, there are gaps that could be exploited. This could include outdated software components, missing security headers, or incomplete SSL/TLS implementation. To bolster the overall security posture, it is imperative to prioritize the development and enforcement of comprehensive compliance documentation. Furthermore, enhancing website and application security through measures like a Web Application Firewall (WAF) and stricter access controls is highly recommended. Addressing these key areas will not only improve the security score but also create a more resilient defense against the evolving landscape of cyber threats.`
            isLoadingSummary.value = false
          }

          function goBack() {
            emit('navigate', props.isAdmin ? 'AdminDashboardPage' : 'DashboardPage')
          }

          onMounted(() => {
            generateSummary()
            const ctx = document.getElementById('reportRadarChart')
            if (ctx) {
              const { scores } = reportData.value
              radarChartInstance.value = new Chart(ctx, {
                type: 'radar',
                data: {
                  labels: ['Website', 'Network', 'Compliance', 'CyberSec'],
                  datasets: [
                    {
                      data: [scores.ws, scores.dn, scores.cd, scores.csi],
                      backgroundColor: 'rgba(59, 130, 246, 0.2)',
                      borderColor: 'rgba(59, 130, 246, 1)',
                      borderWidth: 2,
                    },
                  ],
                },
                options: {
                  responsive: true,
                  maintainAspectRatio: false,
                  scales: { r: { suggestedMin: 0, suggestedMax: 100 } },
                  plugins: { legend: { display: false } },
                },
              })
            }
          })

          watch(reportData, (newData) => {
            generateSummary()
            if (radarChartInstance.value) {
              radarChartInstance.value.data.datasets[0].data = [
                newData.scores.ws,
                newData.scores.dn,
                newData.scores.cd,
                newData.scores.csi,
              ]
              radarChartInstance.value.update()
            }
          })

          return { reportData, summary, isLoadingSummary, goBack }
        },
        template: `<div class="bg-gray-200 p-4 md:p-8"><div class="max-w-4xl mx-auto bg-white shadow-2xl rounded-lg"><header class="bg-gray-800 text-white p-6 rounded-t-lg flex justify-between items-center"><div><h1 class="text-2xl font-bold">Vulnerability Assessment Report</h1><p class="text-sm text-gray-300">For: {{ reportData.name }}</p></div><div class="flex items-center space-x-4"><button @click="goBack" class="flex items-center space-x-2 px-4 py-2 bg-gray-600 rounded-lg hover:bg-gray-700 transition"><BackIcon /><span>Back</span></button><button class="flex items-center space-x-2 px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700 transition"><DownloadIcon /><span>Download</span></button></div></header><main class="p-8"><section class="mb-8 pb-8 border-b"><h2 class="text-xl font-bold text-gray-800 mb-4">Executive Summary</h2><div v-if="isLoadingSummary" class="flex items-center space-x-3 bg-gray-100 p-4 rounded-lg"><div class="animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"></div><p>AI is analyzing the results...</p></div><p v-else class="text-gray-600 leading-relaxed" v-html="summary"></p></section><section class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8 pb-8 border-b"><div><h2 class="text-xl font-bold text-gray-800 mb-4">Score Breakdown</h2><div class="space-y-4"><div class="flex justify-between items-center"><span class="font-medium">Website Strength</span><span class="font-bold text-lg" :class="reportData.scores.ws > 75 ? 'text-green-600' : 'text-yellow-600'">{{ reportData.scores.ws }}</span></div><div class="flex justify-between items-center"><span class="font-medium">Devices & Network</span><span class="font-bold text-lg" :class="reportData.scores.dn > 75 ? 'text-green-600' : 'text-yellow-600'">{{ reportData.scores.dn }}</span></div><div class="flex justify-between items-center"><span class="font-medium">Compliance Documentation</span><span class="font-bold text-lg" :class="reportData.scores.cd > 50 ? 'text-yellow-600' : 'text-red-600'">{{ reportData.scores.cd }}</span></div><div class="flex justify-between items-center"><span class="font-medium">Cyber Security Implementations</span><span class="font-bold text-lg" :class="reportData.scores.csi > 75 ? 'text-green-600' : 'text-yellow-600'">{{ reportData.scores.csi }}</span></div><div class="border-t pt-4 mt-4 flex justify-between items-center"><span class="font-bold text-lg">Overall Score</span><span class="font-extrabold text-2xl" :class="reportData.scores.overall > 75 ? 'text-green-600' : reportData.scores.overall > 50 ? 'text-yellow-600' : 'text-red-600'">{{ reportData.scores.overall }}</span></div></div></div><div class="w-full h-64 md:h-auto"><canvas id="reportRadarChart"></canvas></div></section><section><h2 class="text-xl font-bold text-gray-800 mb-4">Prioritized Recommendations</h2><div class="overflow-x-auto"><table class="min-w-full bg-white"><thead class="bg-gray-100"><tr><th class="py-2 px-4 text-left">Recommendation</th><th class="py-2 px-4 text-left">Category</th><th class="py-2 px-4 text-left">Impact</th></tr></thead><tbody><tr v-for="rec in reportData.prioritizedRecs" :key="rec.rec" class="border-b"><td class="py-3 px-4">{{rec.rec}}</td><td class="py-3 px-4"><span class="text-xs font-medium bg-gray-200 text-gray-700 py-1 px-2 rounded-full">{{rec.category}}</span></td><td class="py-3 px-4 font-bold text-green-600">{{rec.impact}}</td></tr></tbody></table></div></section></main></div></div>`,
      })

      // --- Admin Components ---
      const AdminHeader = defineComponent({
        props: ['isLoggedIn', 'isAdmin'],
        emits: ['navigate', 'logout'],
        template: `
                <header class="bg-white shadow-sm sticky top-0 z-50">
                    <div class="container mx-auto px-6 py-4 flex justify-between items-center">
                        <div class="flex items-center space-x-8">
                            <div class="text-2xl font-bold text-gray-800">IT<span class="text-blue-600">I</span>VA <span class="text-sm font-normal text-red-600">Admin</span></div>
                            <nav class="hidden md:flex items-center space-x-6">
                                <a @click.prevent="$emit('navigate', 'AdminDashboardPage')" href="#" class="text-gray-600 hover:text-blue-600 transition-colors">Dashboard</a>
                                <a @click.prevent="$emit('navigate', 'EditQuestionnairePage')" href="#" class="text-gray-600 hover:text-blue-600 transition-colors">Edit Questionnaire</a>
                            </nav>
                        </div>
                        <button @click="$emit('logout')" class="bg-red-500 text-white font-bold py-2 px-5 rounded-lg hover:bg-red-600 transition-transform transform hover:scale-105 shadow">Logout</button>
                    </div>
                </header>`,
      })

      const AdminDashboardPage = defineComponent({
        name: 'AdminDashboardPage',
        components: { AdminHeader, AppFooter },
        props: ['isLoggedIn', 'isAdmin'],
        emits: ['navigate', 'logout'],
        setup(_, { emit }) {
          const businesses = ref(mockRankings)
          const sortKey = ref('score')

          const sortedBusinesses = computed(() => {
            const sorted = [...businesses.value]
            if (sortKey.value === 'score') {
              return sorted.sort((a, b) => b.score - a.score)
            }
            if (sortKey.value === 'name') {
              return sorted.sort((a, b) => a.name.localeCompare(b.name))
            }
            return sorted.sort((a, b) => {
              if (a[sortKey.value] < b[sortKey.value]) return -1
              if (a[sortKey.value] > b[sortKey.value]) return 1
              return 0
            })
          })

          function viewReport(business) {
            emit('navigate', 'ReportViewerPage', business)
          }

          onMounted(() => {
            console.log('Admin Dashboard: Map would initialize here.')
          })

          return { sortedBusinesses, sortKey, viewReport }
        },
        template: `
                <div class="flex flex-col min-h-screen">
                    <AdminHeader :is-logged-in="isLoggedIn" :is-admin="isAdmin" @navigate="$emit('navigate', $event)" @logout="$emit('logout')" />
                    <main class="flex-grow bg-gray-100 py-12 px-6">
                        <div class="container mx-auto">
                            <h1 class="text-3xl font-bold text-gray-800 mb-8">Admin Dashboard</h1>
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                <!-- Vulnerability Map -->
                                <div class="bg-white p-6 rounded-lg shadow-md"><h2 class="text-xl font-bold mb-4">Vulnerability Landscape Map</h2><div class="w-full h-96 bg-gray-200 rounded-lg flex items-center justify-center"><p class="text-gray-500">[Google Map with business markers would render here]</p></div></div>
                                <!-- Business Ranking List -->
                                <div class="bg-white p-6 rounded-lg shadow-md"><h2 class="text-xl font-bold mb-4">All Assessed Businesses</h2><div class="mb-4"><span class="mr-2 text-sm font-medium">Sort by:</span><button @click="sortKey='score'" :class="['px-3 py-1 text-sm rounded-full mr-2', sortKey==='score' ? 'bg-blue-600 text-white' : 'bg-gray-200']">Score</button><button @click="sortKey='name'" :class="['px-3 py-1 text-sm rounded-full mr-2', sortKey==='name' ? 'bg-blue-600 text-white' : 'bg-gray-200']">Alphabetical</button><button @click="sortKey='location'" :class="['px-3 py-1 text-sm rounded-full mr-2', sortKey==='location' ? 'bg-blue-600 text-white' : 'bg-gray-200']">Location</button><button @click="sortKey='type'" :class="['px-3 py-1 text-sm rounded-full', sortKey==='type' ? 'bg-blue-600 text-white' : 'bg-gray-200']">Type</button></div><div class="h-96 overflow-y-auto custom-scrollbar"><ul class="space-y-2"><li v-for="biz in sortedBusinesses" :key="biz.rank" @click="viewReport(biz)" class="p-3 rounded-md hover:bg-gray-100 cursor-pointer flex items-center justify-between border"><div class="flex items-center"><span class="font-bold text-gray-400 mr-3 w-6 text-center">{{biz.rank}}</span><div><p class="font-semibold text-gray-800">{{biz.name}}</p><p class="text-xs text-gray-500">{{biz.location}} - {{biz.type}}</p></div></div><span class="font-extrabold text-lg" :class="biz.score > 75 ? 'text-green-600' : biz.score > 50 ? 'text-yellow-600' : 'text-red-600'">{{biz.score}}</span></li></ul></div></div>
                            </div>
                        </div>
                    </main>
                    <AppFooter />
                </div>
            `,
      })

      const EditQuestionnairePage = defineComponent({
        name: 'EditQuestionnairePage',
        components: { AdminHeader, AppFooter, Notification },
        props: ['isLoggedIn', 'isAdmin'],
        emits: ['navigate', 'logout'],
        setup() {
          const editableQuestions = ref(JSON.parse(JSON.stringify(mockQuestions)))
          const itemsPerPage = 5
          const currentPage = ref(1)
          const notification = ref({ message: '', type: '' })

          const totalPages = computed(() =>
            Math.ceil(editableQuestions.value.length / itemsPerPage),
          )
          const paginatedQuestions = computed(() => {
            const start = (currentPage.value - 1) * itemsPerPage
            const end = start + itemsPerPage
            return editableQuestions.value.slice(start, end)
          })

          function showNotification(message, type) {
            notification.value = { message, type }
            setTimeout(() => {
              notification.value.message = ''
            }, 3000)
          }

          function saveChanges() {
            console.log('Saving changes to questionnaire...')
            showNotification('Questionnaire updated successfully!', 'success')
          }

          return {
            paginatedQuestions,
            currentPage,
            totalPages,
            saveChanges,
            notification,
            showNotification,
          }
        },
        template: `
                <div class="flex flex-col min-h-screen">
                    <Notification :message="notification.message" :type="notification.type" />
                    <AdminHeader :is-logged-in="isLoggedIn" :is-admin="isAdmin" @navigate="$emit('navigate', $event)" @logout="$emit('logout')" />
                    <main class="flex-grow bg-gray-100 py-12 px-6">
                        <div class="container mx-auto">
                             <h1 class="text-3xl font-bold text-gray-800 mb-8">Edit Questionnaire</h1>
                             <div class="bg-white p-6 rounded-lg shadow-md">
                                <div class="space-y-6">
                                    <div v-for="(question, index) in paginatedQuestions" :key="question.id" class="p-4 border rounded-lg bg-gray-50/50">
                                        <label :for="'q_text_'+question.id" class="block text-sm font-bold text-gray-600">Question {{ (currentPage - 1) * 5 + index + 1 }} ({{question.category}})</label>
                                        <textarea :id="'q_text_'+question.id" v-model="question.text" rows="2" class="w-full mt-1 p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"></textarea>
                                        <div class="mt-2 space-y-2 pl-4 border-l-2 border-gray-200">
                                            <label class="block text-xs font-medium text-gray-500">Options</label>
                                            <div v-for="(option, oIndex) in question.options" :key="oIndex">
                                                <input type="text" v-model="question.options[oIndex]" class="w-full p-2 border border-gray-200 rounded-md text-sm focus:ring-blue-500 focus:border-blue-500">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Pagination and Save Button -->
                                <div class="mt-8 flex justify-between items-center">
                                    <div class="flex items-center space-x-2">
                                        <button @click="currentPage--" :disabled="currentPage === 1" class="px-4 py-2 border rounded-md disabled:opacity-50">Prev</button>
                                        <span class="text-gray-600">Page {{ currentPage }} of {{ totalPages }}</span>
                                        <button @click="currentPage++" :disabled="currentPage === totalPages" class="px-4 py-2 border rounded-md disabled:opacity-50">Next</button>
                                    </div>
                                    <button @click="saveChanges" class="bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 shadow">Save All Changes</button>
                                </div>
                             </div>
                        </div>
                    </main>
                    <AppFooter />
                </div>
            `,
      })

      // --- Root App Component ---
      const App = defineComponent({
        name: 'App',
        components: {
          HomePage,
          AboutUsPage,
          LoginPage,
          DashboardPage,
          QuestionnairePage,
          ReportViewerPage,
          AdminDashboardPage,
          EditQuestionnairePage,
        },
        setup() {
          const currentPage = ref('HomePage')
          const isLoggedIn = ref(false)
          const isAdmin = ref(false)
          const pagePayload = ref({})

          function navigateTo(page, payload = {}) {
            currentPage.value = page
            pagePayload.value = payload
            window.scrollTo(0, 0)
          }
          function login() {
            isLoggedIn.value = true
            isAdmin.value = false
            navigateTo('DashboardPage')
          }
          function adminLogin() {
            isLoggedIn.value = true
            isAdmin.value = true
            navigateTo('AdminDashboardPage')
          }
          function logout() {
            isLoggedIn.value = false
            isAdmin.value = false
            navigateTo('HomePage')
          }

          return {
            currentPage,
            isLoggedIn,
            isAdmin,
            pagePayload,
            navigateTo,
            login,
            adminLogin,
            logout,
          }
        },
        template: `<div><transition name="fade" mode="out-in"><component :is="currentPage" :is-logged-in="isLoggedIn" :is-admin="isAdmin" :payload="pagePayload" @navigate="navigateTo" @login="login" @adminLogin="adminLogin" @logout="logout"></component></transition></div>`,
      })

      createApp(App).mount('#app')
    </script>
  </body>
</html>
